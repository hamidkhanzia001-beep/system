<!DOCTYPE html>
<html lang="ps" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Haji Kochai System</title>
    <style>
        :root { --blue: #1a73e8; --dark: #202124; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f0f2f5; margin: 0; padding: 10px; overflow-x: hidden; }
        .container { max-width: 500px; margin: 10px auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 3px solid var(--blue); margin-bottom: 20px; padding-bottom: 10px; }
        .balance-card { background: var(--dark); color: white; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 20px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 16px; }
        button { width: 100%; padding: 12px; background: var(--blue); color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; -webkit-appearance: none; }
        .item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #eee; background: #fff; }
        .hidden { display: none !important; }
        @media print { .no-print { display: none; } .container { box-shadow: none; width: 100%; max-width: none; margin: 0; } }
    </style>
</head>
<body>

<div id="login-screen" class="container">
    <div class="header"><h2>Haji Kochai Ltd</h2><p>ننوځئ</p></div>
    <input type="number" id="pass-input" placeholder="پاسورډ (1234)" pattern="\d*">
    <button type="button" id="login-btn">داخلېدل</button>
</div>

<div id="main-app" class="container hidden">
    <div class="header">
        <h2 id="biz-name">Haji Kochai Oil & Sugar Ltd</h2>
        <p>د حساباتو کتاب</p>
    </div>

    <div class="balance-card">
        <p style="margin:0; opacity:0.8;">مجموعي حساب</p>
        <h1 id="total-val">0.00 $</h1>
    </div>

    <div class="no-print">
        <input type="text" id="desc" placeholder="تفصیل">
        <input type="number" id="amt" placeholder="مقدار (+ یا -)">
        <button type="button" id="add-btn" style="background: #28a745; margin-bottom: 10px;">ثبتول</button>
        <button type="button" onclick="window.print()" style="background: #5f6368;">راپور چاپول</button>
    </div>

    <div id="history" style="margin-top: 20px;">
        <h3 style="border-right: 4px solid var(--blue); padding-right: 10px;">تاریخچه</h3>
        <div id="items-list"></div>
    </div>
</div>

<script>
    // د پاڼې د ناڅاپي ریفریش مخنیوی
    document.addEventListener('submit', function(e) { e.preventDefault(); }, true);

    let data = JSON.parse(localStorage.getItem('kochai_data_v2')) || [];
    const loginScreen = document.getElementById('login-screen');
    const mainApp = document.getElementById('main-app');

    // د ننوتلو فنکشن
    document.getElementById('login-btn').addEventListener('click', function(e) {
        e.preventDefault();
        const p = document.getElementById('pass-input').value;
        if(p === "1234") {
            loginScreen.classList.add('hidden');
            mainApp.classList.remove('hidden');
            render();
        } else {
            alert("غلط پاسورډ!");
        }
    });

    // د معاملې اضافه کول
    document.getElementById('add-btn').addEventListener('click', function(e) {
        e.preventDefault();
        const d = document.getElementById('desc').value;
        const a = parseFloat(document.getElementById('amt').value);
        if(!d || isNaN(a)) return alert("معلومات سم ولیکئ");

        data.push({ d, a, t: new Date().toLocaleDateString() });
        localStorage.setItem('kochai_data_v2', JSON.stringify(data));
        render();
        document.getElementById('desc').value = '';
        document.getElementById('amt').value = '';
    });

    function render() {
        const list = document.getElementById('items-list');
        list.innerHTML = '';
        let total = 0;
        data.forEach(item => {
            total += item.a;
            list.innerHTML += `<div class="item">
                <span>${item.d} <small style="color:gray;">(${item.t})</small></span>
                <b style="color:${item.a >= 0 ? '#1e8e3e':'#d93025'}">${item.a.toFixed(2)} $</b>
            </div>`;
        });
        document.getElementById('total-val').innerText = total.toFixed(2) + ' $';
    }
</script>

</body>
</html>
